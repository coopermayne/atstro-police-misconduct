---
interface Props {
  imageId: string;
  alt: string;
  caption?: string;
  accountHash?: string;
}

const { 
  imageId, 
  alt, 
  caption,
  accountHash = "3oZsG34qPq3SIXQhl47vqA"
} = Astro.props;

// Cloudflare Images URL format: https://imagedelivery.net/{account_hash}/{image_id}/{variant}
const baseUrl = `https://imagedelivery.net/${accountHash}/${imageId}`;
const thumbnailUrl = `${baseUrl}/thumbnail`;
const mediumUrl = `${baseUrl}/medium`;
const largeUrl = `${baseUrl}/large`;
const publicUrl = `${baseUrl}/public`;
---

<figure class="my-10 not-prose">
  <div class="flex justify-center">
    <div class="w-full md:w-2/3 lg:w-1/2">
      <img 
        src={mediumUrl}
        srcset={`${thumbnailUrl} 400w, ${mediumUrl} 800w, ${largeUrl} 1200w, ${publicUrl} 1600w`}
        sizes="(max-width: 640px) 100vw, (max-width: 1024px) 66vw, 50vw"
        alt={alt}
        class="w-full object-contain max-h-[600px]"
        loading="lazy"
      />
      {caption && (
        <figcaption class="mt-3 px-4 py-2">
          <p class="text-sm text-gray-700 dark:text-gray-300 leading-relaxed italic text-center">
            {caption}
          </p>
        </figcaption>
      )}
    </div>
  </div>
</figure>
